---
layout:     post
title:      "map 的数据结构"
subtitle:   ""
date:       2019-03-05 14:00:00
author:     "frank"
# header-style: text
header-img: "img/post-bg-halting.jpg"
tags:
    - 数据结构
    - 编程
---

今天突然有同事问我，如果发生 hash 碰撞怎么解决，一下子问到我的知识盲区，查了一些资料，并用记下来。

map 使用的是 hashMap 的数据结构，而 hashMap 是由一个长度为 2^n 的数组来存储数据，存储的单元为Entry, Entry 由 key,value 等组成。

put 的时候通过 hash 散列的算法来生成数据的角标，如果两个key生成的hash值一样，就会产生hash碰撞，如下图

![hash](https://www.wangbase.com/blogimg/asset/201809/bg2018090510.png)

解决 hash 碰撞有几种方法： 

* 拉链法 拉链法就是将相同关键字的同义词放到同一线性链表中。 
* 开放地址法 每次冲突后，往后一位或其他规则写入。 
* 再哈希法 当发生冲突时取用第二、第三哈希函数计算地址，直到无冲突。 
* 建立一个公共溢出区

①拉链法处理冲突简单，且无堆积现象，即非同义词决不会发生冲突，因此平均查找长度较短；

②由于拉链法中各链表上的结点空间是动态申请的，故它更适合于造表前无法确定表长的情况； 

③开放定址法为减少冲突，要求装填因子α较小，故当结点规模较大时会浪费很多空间。而拉链法中可取α≥1，且结点较大时，拉链法中增加的指针域可忽略不计，因此节省空间； 

④在用拉链法构造的散列表中，删除结点的操作易于实现。只要简单地删去链表上相应的结点即可。而对开放地址法构造的散列表，删除结点不能简单地将被删结 点的空间置为空，否则将截断在它之后填人散列表的同义词结点的查找路径。这是因为各种开放地址法中，空地址单元(即开放地址)都是查找失败的条件。因此在 用开放地址法处理冲突的散列表上执行删除操作，只能在被删结点上做删除标记，而不能真正删除结点。